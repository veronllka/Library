<UserControl x:Class="Library.Views.ModernDataGridView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Styles/GlobalStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- Анимация появления -->
            <Storyboard x:Key="DataGridEnterAnimation">
                <DoubleAnimation Storyboard.TargetProperty="Opacity" 
                               From="0" To="1" Duration="0:0:0.3">
                    <DoubleAnimation.EasingFunction>
                        <QuarticEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.(TranslateTransform.Y)" 
                               From="20" To="0" Duration="0:0:0.35">
                    <DoubleAnimation.EasingFunction>
                        <QuarticEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
            </Storyboard>
        </ResourceDictionary>
    </UserControl.Resources>

    <UserControl.Triggers>
        <EventTrigger RoutedEvent="UserControl.Loaded">
            <BeginStoryboard Storyboard="{StaticResource DataGridEnterAnimation}"/>
        </EventTrigger>
    </UserControl.Triggers>

    <Grid>
        <Grid.RenderTransform>
            <TranslateTransform/>
        </Grid.RenderTransform>
        
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Заголовок и статистика -->
        <Border Grid.Row="0" Style="{StaticResource GlassCard}" 
                Margin="0,0,0,15" Padding="25,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock x:Name="TitleText" Text="Данные" 
                              FontSize="20" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimaryColor}" Margin="0,0,0,5"/>
                    <TextBlock x:Name="DescriptionText" Text="Описание данных"
                              FontSize="14" Foreground="{StaticResource TextSecondaryColor}"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Style="{StaticResource GlassCard}" Padding="15,10" Margin="0,0,15,0">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="Database" Width="18" Height="18" 
                                                      Foreground="{StaticResource AccentColor}" Margin="0,0,8,0"/>
                            <TextBlock x:Name="CountText" Text="0 записей" FontSize="14" FontWeight="Medium"
                                      Foreground="{StaticResource TextPrimaryColor}"/>
                        </StackPanel>
                    </Border>
                    
                    <Button x:Name="RefreshButton" Style="{StaticResource GlassButton}" 
                           Width="40" Height="40" Click="RefreshButton_Click"
                           ToolTip="Обновить данные">
                        <iconPacks:PackIconMaterial Kind="Refresh" Width="18" Height="18"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Строка поиска -->
        <Border Grid.Row="1" Style="{StaticResource GlassCard}" 
                Margin="0,0,0,15" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Grid Grid.Column="0">
                    <TextBox x:Name="SearchTextBox" Style="{StaticResource GlassTextBox}"
                            Height="40" FontSize="14" 
                            TextChanged="SearchTextBox_TextChanged"/>
                    <TextBlock x:Name="SearchPlaceholder" Text="🔍 Поиск по таблице..." 
                             Foreground="#94A3B8" FontSize="14" 
                             Margin="15,0,50,0" VerticalAlignment="Center"
                             IsHitTestVisible="False" Panel.ZIndex="-1"/>
                    <Button x:Name="ClearSearchButton" 
                           HorizontalAlignment="Right" VerticalAlignment="Center"
                           Width="30" Height="30" Margin="0,0,10,0"
                           Background="Transparent" BorderThickness="0"
                           Cursor="Hand" Click="ClearSearchButton_Click"
                           Visibility="Collapsed">
                        <iconPacks:PackIconMaterial Kind="Close" Width="14" Height="14" 
                                                  Foreground="{StaticResource TextSecondaryColor}"/>
                    </Button>
                </Grid>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="15,0,0,0">
                    <Button x:Name="ExportButton" Style="{StaticResource GlassButton}" 
                           Height="40" Padding="15,8" Click="ExportButton_Click"
                           ToolTip="Экспорт данных">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="FileExport" Width="16" Height="16" Margin="0,0,8,0"/>
                            <TextBlock Text="Экспорт"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- DataGrid -->
        <Border Grid.Row="2" Style="{StaticResource GlassCard}" Padding="0">
            <DataGrid x:Name="MainDataGrid" Style="{StaticResource ModernDataGrid}"/>
        </Border>
    </Grid>
</UserControl> 